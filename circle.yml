# circle.yml
machine:
  python:
    version:
      - 2.7
      - 3.2
  services:
    - docker
    - postgresql


test:
  pre:
    - python manage.py test

  post:
    - docker-compose --file docker-compose-test.yml up --force-recreate -d db
    - docker-compose --file docker-compose-test.yml up --force-recreate web
    - curl --retry 10 --retry-delay 5 -v http://localhost:5000
    - docker-compose --file docker-compose-test.yml stop db
    - docker-compose --file docker-compose-test.yml rm --force -v
